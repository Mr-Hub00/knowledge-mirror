services:
  - type: web
    name: iamhub
    env: python
    region: oregon
    plan: starter
    buildCommand: pip install -r requirements.txt && python manage.py collectstatic --noinput
    startCommand: gunicorn mrhub.wsgi:application --bind 0.0.0.0:$PORT
    autoDeploy: true
    envVars:
      - key: DJANGO_SECRET_KEY
        generateValue: true
      - key: DEBUG
        value: "False"
      - key: DATABASE_URL
        fromDatabase:
          name: iamhub-db
          property: connectionString
      - key: ALLOWED_HOSTS
        value: "iamhub.net,iamhub-fresh-b0gi.onrender.com,localhost,127.0.0.1"
      - key: STORACHA_ENABLED
        value: "True"
      - key: STORACHA_BRIDGE_URL
        value: "https://up.storacha.network/bridge"
      - key: STORACHA_SPACE_DID
        value: "did:key:...        # your Space DID"
      # Optional overrides (these have defaults in your code)
      - key: STORACHA_CAN
        value: "store/add,upload/add,upload/list"
      - key: STORACHA_TOKEN_TTL_SECS
        value: "21600" # optional, default 6h
databases:
  - name: iamhub-db
    ipAllowList: []